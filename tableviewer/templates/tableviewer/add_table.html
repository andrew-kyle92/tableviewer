{% extends 'base.html' %}
{% load static %}

{% block extra_head %}
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
{% endblock %}

{% block content %}
    <div class="mb-3">
        <h3 class="border-bottom mb-4">{{ action }} Table</h3>
    </div>
    <form method="post" action="{% if action == "Edit" %}{% url 'tableviewer:edit-table' pk=object.pk %}{% else %}{% url 'tableviewer:new-table' %}{% endif %}" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.media }}
        {% if form.non_field_errors %}
            {{ form.non_field_errors }}
        {% endif %}

        {# Form Layout #}
        {% with name_field=form.name desc_field=form.description table_file_field=form.table_file  %}
        <div class="form-section mb-4">
            <div class="form-section-title bg-dark-subtle py-3 mb-3">
                <h2 class="ps-2 fs-3">Table Information</h2>
            </div>
            <div class="form-section-body">
                <div class="row mb-3">
                    {# name field #}
                    <div class="form-group col">
                        <label class="form-label" for="{{ name_field.name }}">{{ name_field.label }}</label>
                        {{ name_field }}
                        {# help text #}
                        {% if name_field.help_text %}
                            <div class="form-text">{{ name_field.help_text }}</div>
                        {% endif %}
                        {# field errors #}
                        {% if name_field.errors %}
                            {{ name_field.errors }}
                        {% endif %}
                    </div>
                    {# table_file field #}
                    <div class="form-group col">
                        <label class="form-label" for="{{ table_file_field.name }}">{{ table_file_field.label }}</label>
                        {{ table_file_field }}
                        {# help text #}
                        {% if name_field.help_text %}
                            <div class="form-text">{{ name_field.help_text }}</div>
                        {% endif %}
                        {# field errors #}
                        {% if table_file_field.errors %}
                            {{ table_file_field.errors }}
                        {% endif %}
                    </div>
                </div>
                {# desc field #}
                <div class="form-group col">
                    <label class="form-label" for="{{ desc_field.name }}">{{ desc_field.label }}</label>
                    {{ desc_field }}
                    {# help text #}
                    {% if desc_field.help_text %}
                        <div class="form-text">{{ desc_field.help_text }}</div>
                    {% endif %}
                    {# field errors #}
                    {% if desc_field.errors %}
                        {{ desc_field.errors }}
                    {% endif %}
                </div>
            </div>
        </div>
        {% endwith %}

        {% with logo_field=form.logo results_shown_field=form.results_shown before_text=form.before_table_text after_text=form.after_table_text  %}
        <div class="form-section">
            <div class="form-section-title bg-dark-subtle py-3 mb-3">
                <h2 class="ps-2 fs-3">Table Configuration</h2>
            </div>
            <div class="form-section-body">
                <div class="row mb-3">
                    {# logo field #}
                    <div class="form-group col">
                        <label class="form-label" for="{{ logo_field.name }}">{{ logo_field.label }}</label>
                        {{ logo_field }}
                        {# help text #}
                        {% if logo_field.help_text %}
                            <div class="form-text">{{ logo_field.help_text }}</div>
                        {% endif %}
                        {# field errors #}
                        {% if logo_field.errors %}
                            {{ logo_field.errors }}
                        {% endif %}
                    </div>
                    {# results_shown field #}
                    <div class="form-group col">
                        <label class="form-label" for="{{ results_shown_field.name }}">{{ results_shown_field.label }}</label>
                        {{ results_shown_field }}
                        {# help text #}
                        {% if results_shown_field.help_text %}
                            <div class="form-text">{{ results_shown_field.help_text }}</div>
                        {% endif %}
                        {# field errors #}
                        {% if results_shown_field.errors %}
                            {{ results_shown_field.errors }}
                        {% endif %}
                    </div>
                </div>
                {# before_table_text field #}
                <div class="form-group row mb-3">
                    <label class="form-label" for="{{ before_text.name }}">{{ before_text.label }}</label>
                    <br>
                    {{ before_text }}
                    {# help text #}
                    {% if before_text.help_text %}
                        <div class="form-text">{{ before_text.help_text }}</div>
                    {% endif %}
                    {# field errors #}
                    {% if before_text.errors %}
                        {{ before_text.errors }}
                    {% endif %}
                </div>
                {# after_table_text field #}
                <div class="form-group row mb-3">
                    <label class="form-label" for="{{ after_text.name }}">{{ after_text.label }}</label>
                    <br>
                    {{ after_text }}
                    {# help text #}
                    {% if after_text.help_text %}
                        <div class="form-text">{{ after_text.help_text }}</div>
                    {% endif %}
                    {# field errors #}
                    {% if after_text.errors %}
                        {{ after_text.errors }}
                    {% endif %}
                </div>
            </div>
        </div>
        {% endwith %}

        <div class="btn-group">
            <button class="btn btn-primary" type="submit">Submit</button>
            <a role="button" class="btn btn-secondary" href="{% if action == "Edit" %}{% url 'tableviewer:table-detail' pk=object.id %}{% else %}{% url 'tableviewer:tables-list' %}{% endif %}">Cancel</a>
        </div>
    </form>
{% endblock %}

{% block extra_js %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
{% endblock %}